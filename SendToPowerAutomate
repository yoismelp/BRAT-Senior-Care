Sub Sheet2_Button1_Click()
    'Need to add this line and select worksheet we are going to be
    'pulling values from. In our case, it will be the DataCard
    Worksheets("Sheet2").Activate
    
    Dim DQ As String
    DQ = """"
    Dim NL As String
    NL = vbNewLine
    Dim VT As String
    VT = vbTab
    
    Dim dt As Object, utc As Date
    Set dt = CreateObject("WbemScripting.SWbemDateTime")
    dt.SetVarDate Now
    utc = dt.GetVarDate(False)
    
    Dim json As String
    json = "{" & _
        DQ & "updatedBy" & DQ & ":" & DQ & "Yoismel Perez" & DQ & "," & _
        DQ & "updatedAt" & DQ & ":" & DQ & utc & DQ & "," & _
        DQ & "updatedComment" & DQ & ":" & DQ & "Comments here" & DQ & "," & _
            DQ & "BRAT" & DQ & ":{" & _
            DQ & "version" & DQ & ":" & DQ & "1.4" & DQ & "," & _
            DQ & "name" & DQ & ":" & DQ & "SC" & DQ & "," & _
            "}," & _
            DQ & "data" & DQ & ":[{"
            
    Dim propsDict1 As Dictionary
    Set propsDict1 = New Dictionary
    
    Dim propsDict2 As Dictionary
    Set propsDict2 = New Dictionary
    
    Dim propsDict3 As Dictionary
    Set propsDict3 = New Dictionary
    
    Dim r As Range
    Dim iterator As Integer
    iterator = 0
    Dim indicator As String
    indicator = Range("B7").Value
    
    'Can add while indicator and reset indicator after
    'foreach loop setting the dictionaries
    'but need to make sure we are also setting a new dict to separate
    'Option 1, 2, 3
    If indicator <> "" Then
        For Each r In Range("B7", "B94")
            If Not IsEmpty(r.Value) Or r.Value <> "Senior Care View" Then
                propsDict1.Add r.Value, r.Offset(0, 1)
            End If
            iterator = iterator + 1
            If iterator >= 88 Then
                Exit For
            End If
        Next r
    End If
    
    Dim i As Integer
    
    If propsDict1.Count > 0 Then
        Dim data As String
            For i = 0 To propsDict1.Count - 1
                'Debug.Print i + 1 & " of " & propsDict1.Count & vbNewLine & _
                DQ & propsDict1.Keys()(i) & DQ & ":" & DQ & propsDict1.Items()(i) & DQ & vbNewLine
                data = data & DQ & propsDict1.Keys()(i) & DQ & ":" & DQ & propsDict1.Items()(i) & DQ & ","
            Next i
            data = Left(data, Len(data) - 1)
            data = data & "}"
    End If
    'Add data for Option one to json
    json = json & data
    
    'Close data and master json opening
    json = json & "]}"
    json = Replace(json, vbLf, "")
    Range("B96").Value = json
    Debug.Print json
    
    
    'API Call
    Dim req As New MSXML2.ServerXMLHTTP60
    Dim env As String
    Dim reqUrl As String
    Dim allBody As String
    Dim newBody As String
    Dim RESPONSE As String
    
    reqUrl = Range("G8")
    allBody = Range("B96")
    
    req.Open "POST", reqUrl, False
    req.setRequestHeader "Content-Type", "application/json"
    
    'req.send allBody
    
    RESPONSE = req.responseText
    
        If req.Status <> 202 Then
            MsgBox req.Status & " - " & req.statusText
        Exit Sub
        End If
End Sub
